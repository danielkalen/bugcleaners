(function(){(function(){var f,H,ja,Z,q,aa,P,Q,ba,ka,la,ma,na,V,h,R,I,m,J,ca,S,W,T;ba=function(a){var c;1<a.length?"radio"===a[0].type||"checkbox"===a[0].type?(c=a,a=[],Object.keys(c).forEach(function(d){if(!isNaN(parseFloat(d)))return a.push(c[d])})):(W("onlyOneDOMElement"),a=a[0]):a=a[0];return a};Q=function(a){ca.jQuery&&a.constructor===jQuery&&(a=ba(a),a.length&&(a=a[0]));return a};aa=function(){var a;a=document.createEvent("Event");a.initEvent("change",!0,!1);a.fromSimplyBind=!0;return a};ka=
function(){return"sb_"+Math.floor(1E12*(1+Math.random())).toString(16)};V=function(a){a=typeof a;return"string"!==a&&"number"!==a?!1:!0};ja=function(a,c,d){var g;g=q.objects.indexOf(a);return-1===g?(g={},g[c]=d,q.objects.push(a),q.props.push(g)):q.props[g][c]=d};la=function(a,c){var d;d=q.objects.indexOf(a);return-1!==d&&(d=q.props[d],null!=d[c])?f.boundedObjects[d[c]]:!1};J=function(a,c){return{regEx:new RegExp(I.Start+a+I.End,"g"),lastValue:c||""}};Z=function(a,c,d,g){var f;f=m.objects.indexOf(a);
if(-1===f)return f={},f[c]=J(c,d),m.objects.push(a),m.placeholders.push(f),m.originalValues.push(g);a=m.placeholders[f];return null!=a[c]?a[c].lastValue=d:a[c]=J(c,d)};na=function(a){a=m.objects.indexOf(a);return m.placeholders[a]};ma=function(a){a=m.objects.indexOf(a);return m.originalValues[a]};S=function(a,c){var d;if(!h.silent)throw d=P[a],c&&(d+=" ["+c+"]"),Error(d);};W=function(a,c){var d;if(!h.silent)return d=T[a],c&&(d+=" ["+c+"]"),console.log("SimplyBind: "+d)};P={invalidParamName:"SimplyBind() and .to() can only accept either a string/number representing the name of an object\u2019s property or an already-bound object.",
notAnObject:"SimplyBind: .of() can only accept a non-primitive object as its argument.",emptyStringArg:"SimplyBind() and .to() cannot accept an empty string for a property name."};T={attributes:"DOM Attributes cannot be observed for changes and therefore will not update its dependents upon change",transformFunction:"You can only pass a function to the .withTransform() method",onlyOneDOMElement:"You can only pass one DOM element into SimplyBind unless it's a collection of radio/checkbox inputs",noNestedDOM:"You cannot pass nested properties for DOM attributes or input element values. Will only use the uppermost property."};
ca={jQuery:"undefined"!==typeof jQuery&&null!==jQuery,IE9:!window.atob};h={silent:!1,liveProperties:!0,dispatchEvents:!1,updateEvenIfSame:!1,invokeOnBind:!0,overrideInheritedProps:!1,ignoreCase:!1,placeholderStart:"{{",placeholderEnd:"}}"};R=Object.keys(h);I={Start:"\\{\\{",End:"\\}\\}"};q={objects:[],props:[]};m={objects:[],placeholders:[],originalValues:[]};f=function(a){if(""===a)return S("emptyStringArg");if(!a&&0!==a||!V(a))if(null==a.constructor||a.constructor!==H)return S("invalidParamName");
return"object"===typeof a?(a.invoke("resetConditionals"),a):new H(a)};H=function(a){var c,d,g,da,q,x,r,n,t,X,D,B,I,C,U,J,v,P,w,y,Q,M,e,z,E,l,k,A,F,ea,fa,R,p,K,T,G,ga,ha,ia,L,N,O,oa,u;this.ID=this.type=null;c=this;E=X=u=D=M=null;r=[];n=[];t=[];e=z=null;L=[];l=p=a;N={};k=null;F=[];A=null;K=J=U=y=w=C=!1;Object.defineProperty(this,"value",{configurable:!0,enumerable:!0,get:function(){return D}});Object.defineProperty(this,"origObject",{configurable:!0,enumerable:!0,get:function(){return z||e}});Object.defineProperty(this,
"dependents",{configurable:!0,enumerable:!0,get:function(){var b;b=n.slice().map(function(b){return f.boundedObjects[b].origObject});r.forEach(function(a){return b.push(a)});return b}});T=function(b){return function(){b.ID=ka();return f.boundedObjects[b.ID]=b}}(this);ia=function(b){return function(){var a;if(!b.type&&(b.type="Object",a=null!=e.nodeName&&e.nodeType))return"value"===l?b.type="Value":"textContent"===l?b.type="Text":"prop"===X?b.type="DomProp":b.type="Attr"}}(this);ga=function(b){null==
b&&(b=B());return Z(b,E,u,M)};ha=function(b){if(K)return[].slice.call(b.childNodes).forEach(function(b){if(3!==b.nodeType)return ha(b);if(-1!==b.textContent.indexOf(h.placeholderStart+E+h.placeholderEnd))return Z(b,E,u,b.textContent)})};I=function(b,a){return-1!==m.objects.indexOf(b)?da(b):!1};B=function(){var b;if(!L.length)return e;c.ID||ia();if("Value"===c.type||"Attr"===c.type)return e;b=e;L.slice().reverse().forEach(function(a){return b=b[a]});return b};x=function(b){return function(){var a,
Y;if("Value"===b.type||"Text"===b.type)if(a=function(a){if(!a.fromSimplyBind)return b.set(a.target.value)},Y=z?z[0].nodeName.toUpperCase():e.nodeName.toUpperCase(),"INPUT"===Y||"TEXTAREA"===Y||"SELECT"===Y){if("radio"===e.type||"checkbox"===e.type)return z.forEach(function(b){return b.addEventListener("change",a,!1)});e.addEventListener("input",a,!1);return e.addEventListener("change",a,!1)}}}(this);q=function(b){return K?[].slice.call(b.childNodes).forEach(function(b){var a;if(3!==b.nodeType)return q(b);
a=I(b);if(!1!==a)return b.textContent=a}):b.textContent=u};oa=function(b){return function(a){u=a;D=K?da():a;if("Value"===b.type){if(z)return z.forEach(function(b){if(b.value===a){if(b.checked=!0,h.dispatchEvents)return b.dispatchEvent(aa())}else return b.checked=!1});e.value=D;if(h.dispatchEvents)return e.dispatchEvent(aa())}else if("DomProp"===b.type){if(!J)return e[l]=D}else{if("Attr"===b.type)return e.setAttribute(l,D);if("Text"===b.type)return q(e,a)}}}(this);O=function(b){return function(b,a){var d,
c,e,g;if(n.length)for(e=0,g=n.length;e<g;e++)d=n[e],c=f.boundedObjects[d],a&&-1!==t.indexOf(d)||(d=null!=N[d]?N[d](u,c.value):u,c.set(d,b,!0));if(r.length){d=[];e=0;for(g=r.length;e<g;e++)c=r[e],d.push(c(u));return d}}}(this);da=function(b){var a,d,c;null==b&&(b=B());ga(b);a=ma(b);c=na(b);for(d in c)b=c[d],a=a.replace(b.regEx,b.lastValue);return a};Q=function(b){return function(){var a,d;if(("Object"===b.type||"DomProp"===b.type)&&h.liveProperties&&(a=B().hasOwnProperty(l),d=h.overrideInheritedProps||
a)&&(Object.defineProperty(B(),l,{get:function(){return D},set:function(a){return b.update(a)}}),h.overrideInheritedProps&&!a))return J=!0}}(this);d=function(b){return function(a,c){-1===n.indexOf(a)&&n.push(a);if(c){if(-1===t.indexOf(a))return t.push(a)}else if(-1!==f.boundedObjects[a].getPrivate("dependents").indexOf(b.ID))return f.boundedObjects[a].invoke("addToDependents",[b.ID,!0]),d(a,!0)}}(this);g=function(b){return function(b,a){return N[b]=a}}(this);ea=function(b){return function(a,d){var c;
c=n.indexOf(a);-1!==c&&n.splice(c,1);if(d&&(t.forEach(function(a){return f.boundedObjects[a].invoke("removeDependent",[b.ID])}),c=t.indexOf(a),-1!==c))return t.splice(c,1)}}(this);fa=function(b){return r.splice(r.indexOf(b),1)};R=function(b){return function(){U=w=y=!1;k=A=null;F=[];G();return b}}(this);G=function(b){return function(){delete b.of;delete b.to;delete b.and;delete b.set;delete b.update;delete b.get;delete b.update;delete b.withTransform;delete b.bothWays;delete b.bindTogether;C&&!y||
A||(b.of=v.of);!C||w||y||(b.to=v.to);C&&w&&!y&&!U&&(b.and=v.and);C&&(b.set=v.set,b.update=v.set,b.get=v.get,b.val=v.get);C&&w&&!U&&null!=k&&!A&&(b.withTransform=v.withTransform);C&&w&&!y&&null!=k&&!A&&(b.bothWays=v.bothWays,b.bindTogether=v.bothWays);if(C&&w&&!y&&(null!=k||A))return b.unBind=v.unBind}}(this);P=function(b){return function(a,c){null==c&&(c=[]);switch(a){case "addToDependents":return d.apply(b,c);case "addToTransforms":return g.apply(b,c);case "removeDependent":return ea.apply(b,c);
case "resetConditionals":return R.call(b);case "removeFunction":return fa.call(b,c)}}}(this);a=function(b){return function(b){switch(b){case "dependents":return n;case "dependentFns":return r}}}(this);Object.defineProperty(this,"invoke",{configurable:!1,enumerable:!1,value:P});Object.defineProperty(this,"getPrivate",{configurable:!1,enumerable:!1,value:a});v={of:function(b){var a,c,f;a=null!=b?"object"===typeof b:!1;c=null!=b?V(b):!1;if(!a&&!c)return S("notAnObject","SimplyBind('"+p+"').of("+(null===
b?"null":void 0===b?"undefined":"...")+")");if(y)c=F.indexOf(k),k=k.of(b),F[c]=k,a&&(y=!1,w=!0,d(k.ID),O(this.ID,!0));else if(a){f=!1;b.constructor===H&&(b=b.origObject);C=!0;ca.jQuery&&b.constructor===jQuery&&(f=!0,b=ba(b));e=b;a=B()[l];c=b.constructor.name;if("NodeList"===c||"HTMLCollection"===c||f&&"Array"===c)e=null,z=[].slice.call(b),z.forEach(function(b){if(b.checked)return e=b}),e||(e=z[0]),b=e,a=e.value;if(c=null!=e.nodeName&&e.nodeType)"textContent"===l?(ha(e),a=e.textContent):"value"!==
l&&(a=null===X?b.getAttribute(l):b[l]),L.length&&(W("noNestedDOM"),l=p=b=L[L.length-1]);b=la(B(),p);if("function"===typeof b.invoke&&b.invoke("resetConditionals"))return b;"undefined"===typeof a&&(a=B()[l]=null);D=M=a;K?(u=h.placeholderStart+E+h.placeholderEnd,-1===M.indexOf(u)?(K=!1,u=M):ga()):u=M;T();ja(B(),p,this.ID);ia();Q();x()}else L.push(b);G();return this},to:function(b){if(null==b)return this;if(b.constructor===H)w=!0,k=b,F.push(k),d(k.ID),O(this.ID,!0);else if(V(b))y=!0,k=new H(b),F.push(k);
else if("function"===typeof b)w=!0,-1===r.indexOf(b)&&r.push(b),A=b,h.invokeOnBind&&O(this.ID,!0);else return S("invalidParamName","SimplyBind('"+p+"').of(...).to("+typeof b+")");G();w&&this.update(null,this.ID);return this},and:function(b){return v.to.bind(this)(b)},set:function(b,a,c){null==c&&(c=!1);a===this.ID||b===u&&!h.updateEvenIfSame||(null==a&&(a=this.ID),"undefined"!==typeof b&&oa(b,a),O(a,c));return this},get:function(){return u},withTransform:function(a){var c,d,e;if("function"===typeof a){U=
!0;c=0;for(d=F.length;c<d;c++)e=F[c],g(e.ID,a),-1!==t.indexOf(e.ID)&&e.invoke("addToTransforms",[this.ID,a]);O(this.ID,!0)}else W("transformFunction","SimplyBind('"+p+"').of(...).to(...).withTransform("+typeof a+")");G();return this},bothWays:function(){null!=N[k.ID]?f(k).to(this).withTransform(N[k.ID]):f(k).to(this);d(k.ID,!0);G();return this},unBind:function(a){A?(fa(A),w=!1,A=null):(ea(k.ID,a),w=!1,k=null);G();return this}};"number"===typeof p&&(l=p=p.toString());h.ignoreCase&&(l=p=p.toLowerCase());
-1!==p.indexOf(":")&&(a=p.split(":"),X=a[0],p=a[1],l=a[1]);-1!==p.indexOf(".")&&(K=!0,a=p.split("."),l=a[0],E=a[1],2<a.length&&a.slice(2).forEach(function(a){return E+="."+a}));G();return this};Object.defineProperty(f,"options",{configurable:!1,enumerable:!1,get:function(){return h}});f.setOption=function(a,c){if(-1!==R.indexOf(a))return-1!==a.indexOf("placeholder")&&(a.indexOf("Start"),I[a.slice(11)]=c.replace(/(.)/g,"\\$1")),h[a]=c};f.setOptions=function(a){var c;c=Object.keys(a);if(c.length)return c.forEach(function(c){return f.setOption(c,
a[c])})};f.unBindAll=function(a,c,d){var g,h,m,x,r,n,t;d||f.unBindAllFunctions(a);if(a&&"object"===typeof a&&(a=Q(a),d=null!=a.nodeName&&a.nodeType,g=q.objects.indexOf(a),-1!==g)){r=q.props[g];t=[];for(n in r)x=r[n],m=d&&"value"!==n?a.getAttribute(n):a[n],h=f.boundedObjects[x],g=h.getPrivate("dependents"),g.slice().forEach(function(a){return h.invoke("removeDependent",[a,c])}),c?(delete f.boundedObjects[x],"Value"!==h.type?t.push(Object.defineProperty(a,n,{value:m})):t.push(void 0)):t.push(void 0);
return t}};f.unBindAllFunctions=function(a,c){var d,g,h,m,x;if(a&&"object"===typeof a&&(g=q.objects.indexOf(a),-1!==g)){d=function(a){var c;if(a)return c=f.boundedObjects[a],a=c.getPrivate("dependentFns"),a.slice().forEach(function(a){return c.invoke("removeFunction",a)})};h=q.props[g];if(c)return d(h[c]);x=[];for(m in h)g=h[m],x.push(d(g));return x}};f.SimplyBoundedConstructor=H;f.boundedObjects={};return window.SimplyBind=f})()}).call(this);
