// Generated by CoffeeScript 1.10.0
(function($) {
  var $contentBox, TabItem, scrollTo;
  if ($('.contact_options').length) {
    $contentBox = $$('.contact_options-content');
    $contentBox.data('inited', false);
    TabItem = function(el) {
      var $this;
      $this = $(el);
      this.tab = $(el);
      this.name = this.tab.data('name');
      this.content = $$(".contact_options-content-item." + this.name);
      this.contentHeight = util.getHiddenElementHeight(this.content[0], '620px');
      this.content.find('form').each(function() {
        return new Form($(this));
      });
      this.reveal = function() {
        var expandedHeight, expandedWidth, initedAsMobile, initiated, isMobile;
        initiated = $contentBox.data('inited');
        if (!initiated) {
          this.content.addClass('active');
        }
        this.contentHeight = util.getHiddenElementHeight(this.content[0], '620px');
        scrollTo(this.content);
        isMobile = window.innerWidth > 736;
        expandedWidth = window.innerWidth > 660 ? 620 : window.innerWidth - 40;
        expandedHeight = this.contentHeight;
        if (expandedWidth < 620) {
          initedAsMobile = true;
        }
        if (!initiated) {
          return $contentBox.velocity('stop').velocity({
            'width': expandedWidth
          }, {
            duration: 650,
            easing: 'easeInOutCirc'
          }).velocity({
            'height': expandedHeight
          }, {
            duration: 650,
            easing: 'easeInOutCirc'
          }).data('inited', true);
        } else {
          return $contentBox.velocity('stop').velocity({
            'height': 0
          }, {
            duration: 450,
            easing: 'easeInOutCirc',
            complete: (function(_this) {
              return function() {
                $contentBox.find('.active').removeClass('active');
                return _this.content.addClass('active');
              };
            })(this)
          }).velocity({
            'height': expandedHeight
          }, {
            duration: 650,
            easing: 'easeInOutCirc'
          });
        }
      };
      this.resize = function() {
        var active, animatedDimensions, expandedHeight, expandedWidth, initedAsMobile;
        active = this.content.hasClass('active');
        this.contentHeight = util.getHiddenElementHeight(this.content[0]);
        if (active) {
          expandedHeight = this.contentHeight;
          if (initedAsMobile) {
            expandedWidth = window.innerWidth > 660 ? 620 : window.innerWidth - 40;
            animatedDimensions = {
              'height': expandedHeight,
              'width': expandedWidth
            };
            if (expandedWidth >= 620) {
              initedAsMobile = false;
            }
          } else {
            animatedDimensions = {
              height: expandedHeight
            };
          }
          return $contentBox.velocity('stop').velocity(animatedDimensions, {
            duration: 650,
            easing: 'easeInOutCirc'
          });
        }
      };
      this.tab.on('click', (function(_this) {
        return function() {
          var $siblings;
          $this = $(_this);
          $siblings = _this.tab.siblings();
          _this.tab.addClass('selected').siblings().removeClass('selected');
          return _this.reveal();
        };
      })(this));
      return $$(window).on('resize', util.debounce((function(_this) {
        return function() {
          return _this.resize();
        };
      })(this), 250));
    };
    scrollTo = function(section) {
      var dimensions;
      dimensions = section.offset();
      if (window.pageYOffset > dimensions.top) {
        return $$('html, body').animate({
          scrollTop: dimensions.top - 70
        }, 300);
      }
    };
    return $$('.contact_options-tabs-item').each(function() {
      return new TabItem(this);
    });
  }
})(jQuery);
