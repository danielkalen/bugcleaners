(function(){var e,t;isPageManagement&&(e={list:$(".manage-sidebar"),template:$(fieldTemplates.page),items:[],addExisting:function(e){var i;return i=new t(e.attr("id"),e.data("slug"),e.children().html(),e,e.children(".manage-content-list-title-text")),this.items.push(i),bindPageData(i.el),i},add:function(i){var s,n;return s=this.template.clone(),n=new t("",i.slug,i.label,s,s.children(".manage-content-list-title-text")),this.items.push(n),n.el.data("show",!0).data("new",!0).data("slug",n.slug).attr("id","").addClass(n.slug).find(".manage-content-list-item").data("closed",!0).end().appendTo(e.list),n.show(),initForm(n.el),bindPageData(n.el),n},remove:function(e){var t,i;return i=this.items.filter(function(t){return t.slug===e}),t=this.items.indexOf(i),-1!==t?(this.items.splice(t,1),!0):!1}},t=function(e,t,i,s,n,a){return this.id=e,this.slug=t,this.label=i,this.el=s,this.elTitle=n,this.sidebar=a||SIDEBAR.items.filter(function(e){return e.slug===pageData.slug.value})},t.prototype.show=function(){return this.el.addClass("show").siblings().removeClass("show")},t.prototype.hide=function(){return this.el.removeClass("show")},t.prototype.remove=function(){var t;return t=!this.el.siblings(".step").length,t?alert("You cannot delete the last page in the database."):confirm("Are you sure you want to delete this page?")&&(e.remove(this.slug),SIDEBAR.remove(this.slug),this.id)?DB.page.remove({id:this.id,cb:function(e){return function(t){return t.success?(e.sidebar.remove(),e.el.removeClass("show").prev().addClass("show").end().remove()):void 0}}(this)}):void 0},$(".manage-sidebar-list-item").each(function(){return e.addExisting($(this))}))}).call(this);
